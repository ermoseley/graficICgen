#!/bin/bash
# Create initial conditions for isothermal turbulent box simulations

set -euo pipefail

# --- Arguments ---
if [ "$#" -ne 1 ]; then
    echo "Usage: $0 <refinement_level>"
    exit 1
fi

LVL_MAX=$1

# --- Parameters ---
NAME="dturb"
SIZE_CU=1.0           # box size in code units
SIZE_PH=1.0           # box size in cm
BZ=1.0                # magnetic field strength in code units

# --- Paths ---
MYDIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" >/dev/null && pwd )"
IC_DIR="ic_${NAME}/ic_${NAME}_${LVL_MAX}"

# --- Create directory structure ---
mkdir -p "$IC_DIR"
cd "$IC_DIR"

# --- Generate ICs ---
echo "Generating ICs in $IC_DIR..."
python3 "$MYDIR/generate.py" \
    "$LVL_MAX" \
    "$SIZE_CU" \
    "$SIZE_PH" \
    "$BZ"

echo "IC generation complete."
